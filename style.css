:root{
  --bg:#0e1226; --panel:#141a33; --muted:#97a1c0;
  --knight:#ff5a78; --mage:#60e1ff; --priest:#7affc3; --wild:#f7d046;
  --enemybar1:#ffb703; --enemybar2:#fb5607; --hp:#2ee6a6;
}
*{box-sizing:border-box}
html,body{margin:0;height:100%;background:linear-gradient(#0e1226,#0b0e1f);color:#e7ecff;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
body{overflow:hidden}

/* ===== HUD ===== */
.hidden{display:none}
.topbar{
  padding:10px env(safe-area-inset-right) 10px env(safe-area-inset-left);
  display:grid;grid-template-columns:1fr auto auto;gap:10px;align-items:center
}
.party{display:flex;gap:8px}
.hero{display:flex;align-items:center;gap:8px;background:var(--panel);border-radius:12px;padding:8px 10px}
.portrait{
  width:30px;height:30px;border-radius:8px;display:grid;place-items:center;font-weight:800;
  color:#0b0e1f;background:var(--c)
}
.hero .hp{height:8px;width:86px;border-radius:6px;background:#0a0d1e;overflow:hidden;border:1px solid #1e2547}
.hero .hp .fill{display:block;height:100%;background:linear-gradient(90deg,var(--hp),#1be7ff)}

.enemy{min-width:240px;background:var(--panel);border-radius:12px;padding:8px 12px}
.enemy .name{font-weight:700;margin-bottom:6px}
.enemy .hp{height:10px;border-radius:8px;background:#0a0d1e;overflow:hidden;border:1px solid #1e2547}
.enemy .fill{display:block;height:100%;background:linear-gradient(90deg,var(--enemybar1),var(--enemybar2))}

.actions{display:flex;gap:6px}
.iconbtn{
  width:36px;height:36px;border-radius:10px;border:0;background:#1a2150;color:#e7ecff;
  display:grid;place-items:center;font-weight:800;cursor:pointer
}

.arena{
  position:relative; margin:0 10px; border-radius:16px;
  background:radial-gradient(1200px 300px at 50% 120%,#141a33,#0d1124 60%,#0b0e1f 100%);
  overflow:hidden; height:calc(100vh - 220px);
}
.ftext{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%) translateY(-10px);
  color:#fff;font-weight:800;text-shadow:0 3px 12px rgba(0,0,0,.45);animation:fpop .9s ease-out forwards;pointer-events:none;white-space:nowrap}
@keyframes fpop{0%{opacity:0;transform:translate(-50%,-50%) translateY(10px) scale(.8)}20%{opacity:1;transform:translate(-50%,-50%) translateY(-6px) scale(1)}100%{opacity:0;transform:translate(-50%,-50%) translateY(-40px) scale(1)}}

.blockbar{
  background:#0a0e21;border-top:1px solid #161c3b;
  padding:10px env(safe-area-inset-right) 14px env(safe-area-inset-left);
}
.row{
  display:grid;grid-template-columns:repeat(8,1fr);gap:8px;
  touch-action:none;
  -webkit-user-select:none;
  user-select:none;
  -webkit-touch-callout:none;
}
.block{
  position:relative;height:52px;border-radius:12px;border:0;cursor:pointer;touch-action:manipulation;
  background:#151b36;color:#fff;display:grid;place-items:center;
  box-shadow:inset 0 0 0 2px #1c2550, 0 6px 16px rgba(0,0,0,.25);
  -webkit-user-select:none;
  user-select:none;
  -webkit-touch-callout:none;
}
.block .icon{
  width:34px;height:34px;border-radius:9px;background:var(--bgc,#333);display:block;
  box-shadow:0 6px 16px color-mix(in oklab,var(--bgc) 35%,#000)
}
.block.empty{opacity:.25;filter:saturate(.2)}
.block[data-type="hero"][data-color="knight"] .icon{--bgc:var(--knight)}
.block[data-type="hero"][data-color="mage"]   .icon{--bgc:var(--mage)}
.block[data-type="hero"][data-color="priest"] .icon{--bgc:var(--priest)}
.block[data-type="wild"] .icon{--bgc:var(--wild)}
.block[data-type="wild"] .glyph{position:absolute;font-weight:900;font-size:18px;color:#0b0e1f}

/* Drag halos */
.block.preview { box-shadow:0 0 0 2px #3dd1ff inset, 0 8px 20px rgba(61,209,255,.35), 0 0 0 2px #1c2550; }
.block.preview-core { box-shadow:0 0 0 2px #7affc3 inset, 0 10px 26px rgba(122,255,195,.40), 0 0 0 2px #1c2550; }

/* ===== Overlays (modal) ===== */
.overlay{position:fixed;inset:0;z-index:1000;background:rgba(0,0,0,.55);display:none;align-items:center;justify-content:center;padding:24px}
.overlay.show{display:flex}
.panel{background:#12183a;border:1px solid #1d2653;border-radius:16px;padding:20px;min-width:280px;max-width:520px;text-align:center;box-shadow:0 20px 60px rgba(0,0,0,.35)}
.panel .muted{color:var(--muted)}
.panel .small{font-size:12px}
.tips{padding-left:18px;text-align:left}
.cta{margin-top:10px;padding:10px 14px;border:0;border-radius:12px;font-weight:800;background:#7affc3;color:#0b0e1f;cursor:pointer}
.cta.secondary{background:#1a2150;color:#e7ecff}

.rewardGrid{display:grid;gap:10px;margin:10px 0}
.reward{background:#1a2150;color:#e7ecff;border:1px solid #29306b;border-radius:12px;padding:10px;cursor:pointer}
.reward.selected{outline:3px solid #7affc3}

/* ===== Settings Drawer ===== */
.drawer{position:fixed;inset:0;pointer-events:none}
.drawer .drawer-panel{
  position:absolute;right:10px;top:10px;width:280px;max-width:90vw;
  background:#12183a;border:1px solid #1d2653;border-radius:14px;padding:12px;
  transform:translateY(-20px);opacity:0;transition:.18s ease;pointer-events:auto;display:none
}
.drawer.open .drawer-panel{display:block;transform:translateY(0);opacity:1}
.drawer header{display:flex;align-items:center;justify-content:space-between;margin-bottom:6px}
.field{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:center;margin:10px 0}
.field label{grid-column:1/-1;color:var(--muted);font-size:12px}
.field output{min-width:40px;text-align:right}
